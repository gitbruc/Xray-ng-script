# 禁止Scrapy等工具的抓取，一些通用的编程库或框架使用的 User-Agent，常见于自定义的爬虫或数据抓取脚本
if ($http_user_agent ~* (Scrapy|Curl|HttpClient)) {
    return 444;
}

# 禁止指定UA及UA为空的访问，许多已知或可疑的扫描器、压力测试工具、早期爬虫、恶意机器人、利用特定漏洞探测的 User-Agent 等
if ($http_user_agent ~* "ApacheBench|WebBench|HttpClient|Java|Jullo|python|Python-urllib|Python-requests|Go-http-client|FeedDemon|JikeSpider|Indy Library|FlightDeckReports Bot|Alexa Toolbar|AskTbFXTV|AhrefsBot|CrawlDaddy|CoolpadWebkit|Feedly|UniversalFeedParser|Microsoft URL Control|Swiftbot|ZmEu|oBot|jaunty|lightDeckReports Bot|Linguee Bot|YYSpider|DigExt|YisouSpider|MJ12bot|heritrix|EasouSpider|ZmEu phpmyadmin|WinHttp|LinkpadBot|Ezooms|^$") {
    return 444;
}

# 禁止友好的搜索引擎爬虫抓取
if ($http_user_agent ~* "qihoobot|Baiduspider|Googlebot|Googlebot-Mobile|Googlebot-Image|Mediapartners-Google|Adsbot-Google|Feedfetcher-Google|YandexBot|Yahoo! Slurp|Yahoo! Slurp China|YoudaoBot|Sosospider|Sogou spider|Sogou web spider|MSNBot|ia_archiver|Tomato Bot") {
    return 444;
}

# 禁止非GET|HEAD|POST方式的抓取，开启后反代 cloudreve 无法正常使用
if ($request_method !~ ^(GET|HEAD|POST)$) {
    return 444;
}

# 禁止特殊的user_agent的访问，特定的旧版本 IE 浏览器
if ($http_user_agent ~ "Mozilla/4.0\ \(compatible;\ MSIE\ 6.0;\ Windows\ NT\ 5.1;\ SV1;\ .NET\ CLR\ 1.1.4322;\ .NET\ CLR\ 2.0.50727\)") {
    return 444;
}

# 禁止恶意访问敏感文件类型,例如example.php
location ~* \.(php|php5|php7|phps|pht|py|pl|cgi|asp|aspx|jsp|swp|git|env|yaml|yml|sql|db|bak|ini|docx|doc|log|error|sh|bash)$ {
    return 444;
}

# 禁止恶意访问恶意路径
location ~* (wordpress|wp-admin|wp-content|wp-includes|phpinfo|wlwmanifest|phpMyAdmin|xmlrpc) {
    return 444;
}
